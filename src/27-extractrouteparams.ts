/* eslint-disable no-undef, no-unused-vars, @typescript-eslint/no-unused-vars */

// Make it a module
export {}

/**
 * https://t.co/gfZQy70whg?amp=1
 * https://effectivetypescript.com/2020/11/05/template-literal-types/
 * https://www.typescriptlang.org/play?ts=4.1.0-dev.20201028&ssl=57&ssc=20&pln=57&pc=38#code/PTAEBUFMFsAcBsCGAXSp4EtUCdHwM6gDGiAdqAEZoCu+kAJqMgPaiQAeyuRyoZj0MhljUkqUPi4ZSAc3RZIueEwCesSPgB0AWABQICAAsNaSdmlzMOPKvX4ANKGlNq2Uo5LkqoWgz6FYbGZ1bGQMDUd+YjJQeg0icyo9A1hmfHwMCng0LjJ8ADNmbEEw5lJCfKDoPgkpWSZWGOYKACtIHidyGIBBAAUASR1dZLAAYlHQAGU6uUmELDD68FZu8gB5VvbkPRGIGAQUNCtFPEJPHzpQWBQccv9QACJ8eeQAWlTpZHwHhs78xSYxl2+GoFDMFkIzioyAA7pBIKRNKAAGJFNjsRBwbKaHE7fRgcCGDCEZBqNDEmrg+rHJSgGFEoiGYhlQrFEmNKYwABqilemAA1qYZkNSeoIJMedgMmVQABeR4AFk0AEZNAAmB54gwAdTQ5wSkEONVFOVYHFyHWQxmZcDKCK+oGY+UBKFq5lkQx1kAA5PBlM8rHwEmkSTDWN7NN7iIZENwcFo9CbQABRThxyYwABuigAPBnoNnsNN3XJzQj6IQqTIAHxy0B6UCN-OF4sWdGoUgV0AAAwAJABvaT-bCgACyiBaRQAvpoB0OAaPpNPZ4PSMPQL0UIyp93QAB+eu6RvH4-90CCSfYABcY4nRUc0CX17HT8c12QjJvm4-TKnoBvZ6KEEz4PAAwmQpDMLw1xSqYWYAlWPxTlqYAADLSGgyoSIYzCiIw3j5JiGCYLGTjOiouHetm6DMMwgqMK6VpoIE7QMG2HCYggGhXrsHFYpAV6fEErwsCJ+xiJAfIKEohBgHxXFXoIsDqPQIlkvgrwwlghhiVihxSdYBAoaA6GkGgapOIQiDMp2WAYGUNgmo44BkpMCTCLwmZ4Bg9CHCSMa8ExfwAu+tznluxj4LsiAyIg0iSJyBaKK29QwZikA4EMuymWgADMlmAmg2AaKIvBOoVNn0HZDnwI4GDOlw1A5MY5CBMwmY+WgTSbDwuxaVaFUgmCMwBIg6R+J8rBVfkw72lcaTVXczjdW0PBIv0DXWlWuz0MwGigJBvAlIyjhMeQxXIK45BBUm-VMjEQFovgMbqFluhJuAkx1qmFrIM2uafZK0qkNWxmEhSYakN6vAxp22SJZKoDKgADMjACkjhUCQvhOLwFIPRi-E8e9ZKgAAQog9D-dgZPUMgawANIpXI8o-em8HYDmDxKsjmioq4mgKkLCoPKDwz4qAAASzBwoWjhs4gPDU3SxHKIRxGOuQVaEPSGCMrEZTQ6A+RYBVrIlEi4NnGNkB9armvwCo4U-nSLWUjMoAxv5aDm66DwABqaAAmpoABaDyOLr+tBWZnDyGZBv7YdxNJtTybYMB31porf0c1z-Mjh8pC8KHiisEXvDIhg2ai8Z4ygAASu0rgZNRzNTC8iwyGD1osR1uGEPJ8NaX6DtO2G2D8q7CKgBR1Ce4g1EEznbptiwzsnbsrLnkUaCkNQZBEH4JB0IQc90mQvAT1Pd0VS56hueYsC8DzxuGpdxU3kPAleeYlN6yJagXEEziwMMsCQLx3Ylk6OvYqrxaCICyHqZgtozLFwcBAIB2QrLFRqDIWijAYSICduvQUkBYC7AtFPcqQViogngF8JEktFA+ishAwMJpiaJlJnMKweZ2zlkrDMRwAARARnYhEllrLKBsx4qziK7F9A8VYADaABdf8siTxNgUYQb0UYDzqM0UebRpivplgkT2Oca4ATgCnAOER9jVzrgAKo7n3I2FR4BHA4k0LwrAOYXGiOrBom8oAVGTDUQAbmMjlJGsR2hIDoUwMMVxYyYgwXCX0ygcYZFkPDRk6SeCKAqGiCgxUOqkk9GAL6xUWJ0HQYND268AxYEiJ2UAYiKRBTiJgR8pAUBFEtkSKKEtMAJwRCCZJTEnaxjQBQKCTJtZvQMHEiyjJ2j8khM6eR+N5CGUxk7DZRB+RtnqnghEJx-QzF2OcbwFi4iMEqCgiq0gRC8CrOtHZzBHAXSulAtssZcAqCRLqW5ZAjbXxVgNSCpADJXNXh6YyyZNAyCRFaCkJ8BLcLFJMLC8p-HIBzFWRwDxNC11AWhDCoB8rHK2WRJp0CKT7FJHVb5oA-luD4OQFlJCsG2xJriiyBKXhcwjo8clYtsrUoVAvNhGRHxJOjJs34uERwKyVhzL5jK2zHUirsbsKjejFRNuwe44A1EqJEZAPp0hBnYEtZMagM0MBmrGqAFxajdxnXbHGCqLFTWgAABTgAAJQwNYExLeGApTQXSdADKAJyrWUulxU6bs4HYGoOQQlmtBrOsDUGlx4b16TNcAKgwVpXTQF3i6cgdoN5MjuT7XCnZqm7A2jq+ou0k5QU6EQeA1A4gVV6Rgfp9r00z05V0FwXFHTOiwrsbIsgBpRybWUZAcU7hBXkdccajBlpWS6NgGQ1AE3F2DZMUNKyaljrnVinFaBJj5RFXwh4qoNSkslcZbU9tipEBbmgMoR9fgyAynwUeQVIyVk7gwR9UxZWvoCe+9UmhcrirJRS3Yv6BoYsIPySCMJsj0DA44c+z1cLwHwl1JBvxiqU25YwbNcRY1RAAI7UAUHwLekAYTzoqkQFB0Bs1YCdt-QgNDxJGhpKcRw29v7ExALsV4oBVjonqYQIIdM0DmjjGUp2IiYhcn4IofkmJdiGGQMgWA+ArwgFhAsRQmhBPQGAL5UgmZ6D8mAJIFAtBgDKlysjZUAB2ZGYW1QADYACs4XlQAE4AAcCpIsKhGMp1TCSTakEWsbNEu0APnuQJoDjigVAZmyDwfTL5BSNxUGQCzVmbN2eAA5qzTmXPAEfIKbA9XOyQEzD5zdl18ABaC8lkLao1Qhfi8F1GaposKhCyF9LEteiQGCPDGMS8CBmnYCEMd9o-C3w41xlz8wSCoEYLu2MdApSHgMLQNeUnxDyJkwQSODJ7q4PyNm0AKmKB0wOn2-9Qnyx+FZLsNq9BqA8HsuQQTcQKA2xAUpiWlnrO2ZADIbSoJnMoOADIHCohMCKGAIgOE+AUGSVQHpVA8KlBqTsLsXYawRz0cYEFCCraj5FcoPAZgchUiSEU2ADHzWQBxEzFkQXWhHzBip-kYrnWTT4Hcs-cnpBILZqIBYJn8Qn5vAVK8ZUrxoSIGAKMWnBx6fvf1-gIAA
 *
 * 1st form: ExtractRouteParams<"/posts">
 * 2nd form: ExtractRouteParams<"/posts/:postId">
 * 3rd form: ExtractRouteParams1<"/posts/:postId/:commentId">
 */

/**
 * Start with 3rd form or 1st form
 */
type ExtractRouteParams1<
	T extends string
> = T extends `${infer Start}:${infer Param}/${infer Rest}` // 3rd form
	? { [k in Param]: string }
	: {} // 1st form

type Test1_1 = ExtractRouteParams1<"/posts/:postId"> // (nok) type Test1_1 = {}
type Test1_2 = ExtractRouteParams1<"/posts/:postId/:commentId"> // (nok) type Test1_2 = { postId: string; }
type Test1_3 = ExtractRouteParams1<"/posts"> // (ok) type Test1_3 = {}

type ExtractRouteParams2<
	T extends string
> = T extends `${infer Start}:${infer Param}/${infer Rest}` // 3rd form
	? { [k in Param]: string }
	: T extends `${infer Start}:${infer Param}`
	? { [k in Param]: string }
	: {} // 1st form

type Test2_1 = ExtractRouteParams2<"/posts/:postId"> // (ok) type Test2_1 = { postId: string; }
type Test2_2 = ExtractRouteParams2<"/posts/:postId/:commentId"> // (nok) type Test1_2 = { postId: string; }
type Test2_3 = ExtractRouteParams2<"/posts"> // (ok) type Test2_3 = {}

type ExtractRouteParams3<
	T extends string
> = T extends `${infer Start}:${infer Param}/${infer Rest}` // 3rd form
	? { [k in Param | keyof ExtractRouteParams3<Rest>]: string }
	: T extends `${infer Start}:${infer Param}`
	? { [k in Param]: string }
	: {} // 1st form

type Test3_1 = ExtractRouteParams3<"/posts/:postId"> // (ok) type Test3_1 = { postId: string; }
type Test3_2 = ExtractRouteParams3<"/posts/:postId/:commentId"> // (ok) type Test3_2 = { postId: string; commentId: string; }
type Test3_3 = ExtractRouteParams3<"/posts"> // (ok) type Test3_3 = {}
type Test3_4 = ExtractRouteParams3<"/posts/:postId/comments/:commentId"> // (ok) type Test3_4 = { postId: string; commentId: string; }
type Test3_5 = ExtractRouteParams3<string>
let test3_5_1: Test3_5 = { postId: "string", commentId: "string" }
let test3_5_2 = test3_5_1.postId // (nok) Property 'postId' does not exist on type '{}'.ts(2339)
let test3_5_3 = test3_5_1.abc // (nok) Property 'abc' does not exist on type '{}'.ts(2339)

type wisstringextends<S extends string> = string extends S
	? Record<string, string>
	: false
type TestWises_1 = wisstringextends<string>
type TestWises_2 = wisstringextends<"astring">

type ExtractRouteParams4<T extends string> = string extends T // From  https://www.typescriptlang.org/play link:
	? // Checks if string is a literal,
	  // by checking if a general string can be extended from the input string. We
	  // can't work with non-literal string.
	  Record<string, string>
	: T extends `${infer Start}:${infer Param}/${infer Rest}` // 3rd form
	? { [k in Param | keyof ExtractRouteParams4<Rest>]: string }
	: T extends `${infer Start}:${infer Param}` // 2nd form
	? { [k in Param]: string }
	: Record<string, string> // 1st form

type Test4_1 = ExtractRouteParams4<"/posts/:postId"> // (ok) type Test4_1 = { postId: string; }
type Test4_2 = ExtractRouteParams4<"/posts/:postId/:commentId"> // (ok) type Test4_2 = { postId: string; commentId: string; }
type Test4_3 = ExtractRouteParams4<"/posts"> // (ok) type Test4_3 = {}
type Test4_4 = ExtractRouteParams4<"/posts/:postId/comments/:commentId"> // (ok) type Test4_4 = { postId: string; commentId: string; }
type Test4_5 = ExtractRouteParams4<string> // (ok) type Test4_5 = { [x: string]: string; }

type ExtractRouteParams5<
	T extends string
> = T extends `${infer Start}:${infer Param}/${infer Rest}` // 3rd form
	? { [k in Param | keyof ExtractRouteParams4<Rest>]: string }
	: T extends `${infer Start}:${infer Param}` // 2nd form
	? { [k in Param]: string }
	: Record<string, string> // 1st form

type Test5_1 = ExtractRouteParams5<"/posts/:postId"> // (ok) type Test5_1 = { postId: string; }
type Test5_2 = ExtractRouteParams5<"/posts/:postId/:commentId"> // (ok) type Test5_2 = { postId: string; commentId: string; }
type Test5_3 = ExtractRouteParams5<"/posts"> // (ok) type Test5_3 = { [x: string]: string; }
type Test5_4 = ExtractRouteParams5<"/posts/:postId/comments/:commentId"> // (ok) type Test5_4 = { postId: string; commentId: string; }
type Test5_5 = ExtractRouteParams5<string> // (ok) type Test5_5 = { [x: string]: string; }
let test5_5_1: Test5_5 = { postId: "string", commentId: "string" }
let test5_5_2 = test5_5_1.postId // (ok) postId is NOT selectable; postId is string, test5_5_2 is string
let test5_5_3 = test5_5_1.abc // (ok) abc is NOT selectable; abc is string, test5_5_3 is string
